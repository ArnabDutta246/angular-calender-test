import { HttpClient } from "@angular/common/http";
import { Injectable } from "@angular/core";
import { AllCollectionsService } from "./all-collections.service";
import { map } from "rxjs/operators";
import { AngularFireAuth } from "@angular/fire/auth";
import { AngularFirestore } from "@angular/fire/firestore";

@Injectable({
  providedIn: "root",
})
export class ProfileImageService {
  public imageBase64Array = [];
  constructor(
    public http: HttpClient,
    private afs: AngularFirestore,
    private allCol: AllCollectionsService
  ) {
    this.imageBase64Array.push(
      "data:image/jpeg;base64,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"
    );
    this.imageBase64Array.push(
      "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/4gIoSUNDX1BST0ZJTEUAAQEAAAIYAAAAAAIQAABtbnRyUkdCIFhZWiAAAAAAAAAAAAAAAABhY3NwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAA9tYAAQAAAADTLQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlkZXNjAAAA8AAAAHRyWFlaAAABZAAAABRnWFlaAAABeAAAABRiWFlaAAABjAAAABRyVFJDAAABoAAAAChnVFJDAAABoAAAAChiVFJDAAABoAAAACh3dHB0AAAByAAAABRjcHJ0AAAB3AAAADxtbHVjAAAAAAAAAAEAAAAMZW5VUwAAAFgAAAAcAHMAUgBHAEIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFhZWiAAAAAAAABvogAAOPUAAAOQWFlaIAAAAAAAAGKZAAC3hQAAGNpYWVogAAAAAAAAJKAAAA+EAAC2z3BhcmEAAAAAAAQAAAACZmYAAPKnAAANWQAAE9AAAApbAAAAAAAAAABYWVogAAAAAAAA9tYAAQAAAADTLW1sdWMAAAAAAAAAAQAAAAxlblVTAAAAIAAAABwARwBvAG8AZwBsAGUAIABJAG4AYwAuACAAMgAwADEANv/bAEMAAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/bAEMBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIADQANgMBIgACEQEDEQH/xAAcAAEBAAICAwAAAAAAAAAAAAAABwIIBAYDBQv/xAAnEAABBQACAwACAgIDAAAAAAACAQMEBQYAEQcSExQhIzEIFSIyUf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwD5/wDxxyxeNcvnP9RoPI24ZemZXJuxIcSjYdKO7qdLORTg06yRRSZhMtD+XZm3/KMcgIRNtHQII7xy8n/kVvGDWPSwsjQ0Qr6NZyvytOVWMcV6Fh1ZMZ6W92HQuufktk4vsYo2q9J5dHAzXknE2vkDNUkLL6rKPRE2+cqRVqlsK6xeViNo6WIqksFW5S/GwgtqTTYdvkSEguSggPHHOU5BmsxY056HKahTTfbhzHI7rcWWcUgGSEaQQIy+cYnGxfFozVkjBHEFSHsOLxxxwHL5RR3dL4A09LVir1pj93E2dlCaX2ffoJtKVM5MbZT+R4K+Q2TsohEhjx+3XFFFTuBoiqvSJ2q/pET+1X/zmzGEzA+JHqjfb3XTMZMksK9WY6miM2Wsvat5R+jdrXyl/AraqcA+vpaipOEP9RJbLaiGs/L74zYdoPGvl3X2QKzVW2cDD1H17FLS8t5bThhDRU/mOrjNLLfUf022RKiqoOIPu7fyd4HsLo7NPBzpibyukreok1DDqqXspnS1zZ1oKq/smWnEaL9oXaKvfYNQ7lfPDFVV4bSHk7Kli/j5/wAXX8OBUUTziiqvjnrKuJIR2MpR7EbFClSCP0EozAmohrhUYbaaCGlhR5PR3EBXDZSbWUtjOiq6119GxkRo7jSm2pIhihqoqqISIvLzrMDupPhrxJVR8dqH7Kts985YV7VFZuTIITLWI7DOXGGMr0cJTYmccngBHhEibUkTvkSDReQcQ7LzbN/q8w5Xy3m5dPGtrOsGNM7RHlOIxIabFw+hJXBFUdH1cEjEhJbVrN3t43hnxJaR9fp2LGytN8FhYNXtm3MnBDtYjcQJcoJKPSAjNkYRxeM0ZEiFtBRVTga+3eY0maOOGioLmiOWLhxRt62ZXLJFlQR4mElstfZGlcbRz5+3zVwPbr3HtzG50ui0Zxz0F9cXhxBcCKVvZzLEowuqCuiwst574o6rbauI36+6gHt36D04FT8O1tZWtaryhfRGZ9b48gxZFXXSU7Ys9daPFGzzDo9orkeI+BzZCAik2oR3VRQEhKUX19baa3n3t5NesLSykHIlyXi7IjL/AKgAp/xaYaBBaYYbQWmGQBpoRABFO4R9nXx/FE/BhElpb2G4i6R+wRWUgnVRKZYLUI0+n5CyQmkUhE+Ss/Mu/ojgoKzjgOZAZtGDjZk242Qm24BKBgYKhAYEKoQkJIhCQqiiqIqKipzHjgbB6qUvlDxcxvZSC5tcDNgZzXTBBEeu8/YorWeupxD2rk6NJAqx58095HZvOudCy2EFcmzHo0aE7Lkuw4ZPnEiOPunGinKUCknGYI1aYKQTbZPk0Aq6rYK4pKI9d9xWzgZvPeRKOwiS5Y7LOMVcP8f4/KPZRJ7UuJKlo64BIyyn2JCZF11HPQUbQTJwJzwHHHHAccccBxxxwHHHHAccccD/2Q=="
    );
    this.imageBase64Array.push(
      "data:image/jpeg;base64,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"
    );
    this.imageBase64Array.push(
      "data:image/jpeg;base64,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"
    );
    this.imageBase64Array.push(
      "data:image/jpeg;base64,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"
    );
  }

  shuffle() {
    var currentIndex = this.imageBase64Array.length,
      temporaryValue,
      randomIndex;

    // While there remain elements to shuffle...
    while (0 !== currentIndex) {
      // Pick a remaining element...
      randomIndex = Math.floor(Math.random() * currentIndex);
      currentIndex -= 1;

      // And swap it with the current element.
      temporaryValue = this.imageBase64Array[currentIndex];
      this.imageBase64Array[currentIndex] = this.imageBase64Array[randomIndex];
      this.imageBase64Array[randomIndex] = temporaryValue;
    }

    return this.imageBase64Array[0];
  }

  profileImgErrorHandler(users: any, navData: any, uidList: any = []) {
    console.log("full users list ", users);
    console.log("full nav data ", navData.uidList);
    console.log("full uid list ", uidList);
    // console.log("error for image url", user);
    // get the user data
    // user.picUrl = '../../assets/imgs/profile.png';
    if (uidList.length == 0) {
      users.forEach((u, i) => uidList.push(u.uid));
    }
    // Now combine this with the existing list of navuidList, if there is an additional value then get
    // new set of snapshot else just assign the values from the list
    uidList = Array.from(new Set([...uidList, ...navData.uidList]));
    let requiredNewSnapShot = uidList.length != navData.uidList.length;
    if (requiredNewSnapShot) {
      console.log("fectching new profile data", uidList, navData.uidList);
      this.afs
        .collection<any>(
          this.allCol.users,
          (ref) =>
            ref
              .where("subscriberId", "==", navData.subscriberId)
              .where("uid", "in", uidList)
          // .where("meetingStart",">",meetingStart)
        )
        .snapshotChanges()
        .pipe(
          map((actions: any[]) =>
            actions.map((a: any) => {
              const data = a.payload.doc.data();
              const id = a.payload.doc.id;
              return { id, ...data };
            })
          )
        )
        .subscribe((data) => {
          navData.accessedProfilesData = data;
          navData.uidList = uidList;
          this.getUpdatedProfileInfo(users, navData);
        });
    } else {
      this.getUpdatedProfileInfo(users, navData);
    }
  }

  getUpdatedProfileInfo(users: any, navData: any) {
    let profiles = navData.accessedProfilesData;
    users.forEach((u, i) => {
      let uPos = profiles.findIndex((p, i) => p.uid == u.uid, u);
      if (
        uPos != -1 &&
        (profiles[uPos].name != u.name || profiles[uPos].picUrl != u.picUrl)
      ) {
        let refUser = profiles[uPos];
        u.name = refUser.name;
        u.picUrl = refUser.picUrl;
      }
    });
  }
}
